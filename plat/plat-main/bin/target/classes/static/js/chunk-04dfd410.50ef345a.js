(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04dfd410"],{"0fea":function(e,t,a){"use strict";a.d(t,"i",(function(){return n})),a.d(t,"j",(function(){return s})),a.d(t,"l",(function(){return l})),a.d(t,"m",(function(){return i})),a.d(t,"n",(function(){return c})),a.d(t,"f",(function(){return d})),a.d(t,"q",(function(){return u})),a.d(t,"a",(function(){return m})),a.d(t,"k",(function(){return p})),a.d(t,"t",(function(){return h})),a.d(t,"d",(function(){return f})),a.d(t,"o",(function(){return b})),a.d(t,"u",(function(){return y})),a.d(t,"p",(function(){return v})),a.d(t,"v",(function(){return C})),a.d(t,"e",(function(){return g})),a.d(t,"g",(function(){return w})),a.d(t,"r",(function(){return D})),a.d(t,"b",(function(){return k})),a.d(t,"h",(function(){return S})),a.d(t,"s",(function(){return I})),a.d(t,"c",(function(){return x}));var r=a("b775"),o={user:"/myuser/list",role:"/role",service:"/service",permission:"/permission",permissionNoPager:"/permission/no-pager",orgTree:"/org/tree",departmentTree:"/department/tree",departmentList:"/department/find",departmentPost:"/department/post",departmentPut:"/department/put",departmentDelete:"/department/delete",subCompanyTree:"/subCompany/tree",subCompanyTree2:"/subCompany/tree2",subCompanyUserTree:"/subCompany/user-tree",subCompanyList:"/subCompany/find",subCompanyPost:"/subCompany/post",subCompanyPut:"/subCompany/put",subCompanyDelete:"/subCompany/delete",userList:"/user/find",userPost:"/user/post",userPut:"/user/put",userDelete:"/user/delete",workInfoList:"/workInfo/find",workInfoPost:"/workInfo/post",workInfoPut:"/workInfo/put",workInfoDelete:"/workInfo/delete",familyInfoList:"/familyInfo/find",familyInfoPost:"/familyInfo/post",familyInfoPut:"/familyInfo/put",familyInfoDelete:"/familyInfo/delete",jobList:"/jobMask/find",jobPost:"/jobMask/post",jobPut:"/jobMask/put",jobDelete:"/jobMask/delete",teamWork:"/teamWork",userTree:"/subCompany/user-tree/"};function n(e){return Object(r["b"])({url:o.role,method:"get",params:e})}function s(e){return Object(r["b"])({url:o.service,method:"get",params:e})}function l(e){return Object(r["b"])({url:o.subCompanyTree,method:"post",data:e})}function i(e){return Object(r["b"])({url:o.subCompanyTree2,method:"post",data:e})}function c(e){return Object(r["b"])({url:o.subCompanyUserTree,method:"post",data:e})}function d(e){return Object(r["b"])({url:o.departmentList,method:"post",params:e})}function u(e){var t="";return t=e.id&&""!==e.id?o.departmentPut:o.departmentPost,Object(r["b"])({url:t,method:"post",data:e})}function m(e){return Object(r["b"])({url:o.departmentDelete,method:"post",data:e})}function p(e){return Object(r["b"])({url:o.subCompanyList,method:"post",params:e})}function h(e){var t="";return t=e.id&&""!==e.id?o.subCompanyPut:o.subCompanyPost,Object(r["b"])({url:t,method:"post",data:e})}function f(e){return Object(r["b"])({url:o.subCompanyDelete,method:"post",data:e})}function b(e){return Object(r["b"])({url:o.userList,method:"post",params:e})}function y(e){var t="";return t=e.id&&""!==e.id?o.userPut:o.userPost,Object(r["b"])({url:t,method:"post",data:e})}function v(e){return Object(r["b"])({url:o.workInfoList,method:"post",params:e})}function C(e){var t="";return t=e.id&&""!==e.id?o.workInfoPut:o.workInfoPost,Object(r["b"])({url:t,method:"post",data:e})}function g(e){return Object(r["b"])({url:o.workInfoDelete,method:"post",data:e})}function w(e){return Object(r["b"])({url:o.familyInfoList,method:"post",params:e})}function D(e){var t="";return t=e.id&&""!==e.id?o.familyInfoPut:o.familyInfoPost,Object(r["b"])({url:t,method:"post",data:e})}function k(e){return Object(r["b"])({url:o.familyInfoDelete,method:"post",data:e})}function S(e){return Object(r["b"])({url:o.jobList,method:"post",params:e})}function I(e){var t="";return t=e.id&&""!==e.id?o.jobPut:o.jobPost,Object(r["b"])({url:t,method:"post",data:e})}function x(e){return Object(r["b"])({url:o.jobDelete,method:"post",data:e})}},2736:function(e,t,a){"use strict";var r=a("aa66"),o=a.n(r);o.a},"2c06":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{span:5}},[a("a-button",{attrs:{type:"primary",icon:"reload"},on:{click:function(t){return e.loadTree(!1)}}},[e._v("刷新")]),a("department-tree",{ref:"tree",on:{fatherMethod:e.handleTitleClick}})],1),a("a-col",{attrs:{span:19}},[a("div",[a("a-tabs",{ref:"tabs",attrs:{"default-active-key":"1"},on:{change:e.changeTab}},[a("a-tab-pane",{key:"1",attrs:{tab:"部门信息"}},["department"===this.selectType?a("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:e.handleEdit2}},[e._v("编辑部门")]):e._e(),"subCompany"===this.selectType?a("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:e.handleEditSub2}},[e._v("编辑分部")]):e._e(),a("department-info",{ref:"departmentInfo"})],1),"subCompany"===e.selectType?a("a-tab-pane",{key:"4",attrs:{tab:"下级分部"}},[a("sub-company-list",{ref:"supSubTable",attrs:{supSubCompanyId:e.selectKey},on:{onAdd2:e.handleAddSub,onEditSub:e.handleEditSub,onDetail:e.handleDetail}})],1):e._e(),a("a-tab-pane",{key:"2",attrs:{tab:"下级部门","force-render":""}},[a("department-list",{ref:"table",on:{onEdit:e.handleEdit,onAdd:e.handleAdd,onDetail:e.handleDetail}})],1),"department"===e.selectType?a("a-tab-pane",{key:"3",attrs:{tab:"人力资源"}},[a("user-list",{ref:"userTable",attrs:{departmentId:e.selectKey},on:{onAddUser:e.handleAddUser,onEditUser:e.handleEditUser,onDetailUser:e.handleDetailUser}})],1):e._e()],1)],1)])],1),a("edit",{ref:"edit",attrs:{orgTree:e.orgTree,subTreeData:e.subTreeData},on:{ok:e.handleSaveOk,close:e.handleSaveClose}}),a("edit-sub",{ref:"editSub",attrs:{subTreeData:e.subTreeData},on:{ok:e.SaveSubOk,close:e.SaveSubClose}}),a("edit-user",{ref:"editUser",attrs:{orgTree:e.orgTree},on:{ok:e.SaveUserOk,close:e.SaveUserClose}}),a("department-detail",{ref:"detail"})],1)},o=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.treeData.length>0?a("a-tree",{ref:"tree",attrs:{"show-line":"","default-expanded-keys":e.expandedKeys,"auto-expand-parent":e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,"selected-keys":e.selectedKeys,"tree-data":e.treeData},on:{expand:e.onExpand,select:e.onSelect},model:{value:e.checkedKeys,callback:function(t){e.checkedKeys=t},expression:"checkedKeys"}}):e._e()},s=[],l=a("351c"),i=(a("dd32"),{name:"DepartmentTree",components:{aTree:l["b"]},data:function(){return{expandedKeys:[],autoExpandParent:!0,defaultExpandAll:!0,checkedKeys:[],selectedKeys:[],treeData:[]}},watch:{checkedKeys:function(e){console.log("onCheck",e)},selectedKeys:function(e){console.log("watch onSelect",e)}},methods:{loadData:function(e,t){console.log("loadData data",e),this.treeData=e,this.selectedKeys[0]=t,console.log("this.selectedKeys",this.selectedKeys)},onExpand:function(e){console.log("onExpand",e),this.expandedKeys=e},onSelect:function(e,t){console.log("onSelect",t),this.selectedKeys=e,this.$emit("fatherMethod",t)}}}),c=i,d=(a("2736"),a("4023")),u=Object(d["a"])(c,n,s,!1,null,null,null),m=u.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"部门名称"}},[a("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.departmentName,callback:function(t){e.$set(e.queryParam,"departmentName",t)},expression:"queryParam.departmentName"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"部门状态"}},[a("a-select",{attrs:{placeholder:"请选择","default-value":"0"},model:{value:e.queryParam.canceled,callback:function(t){e.$set(e.queryParam,"canceled",t)},expression:"queryParam.canceled"}},[a("a-select-option",{attrs:{value:"0"}},[e._v("启用")]),a("a-select-option",{attrs:{value:"1"}},[e._v("封存")])],1)],1)],1),a("a-col",{attrs:{md:e.advanced?24:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("新建部门")]),e.selectedRowKeys.length>0?a("a-dropdown",{directives:[{name:"action",rawName:"v-action:update",arg:"update"}]},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1",on:{click:function(t){return e.batchDelete()}}},[a("a-icon",{attrs:{type:"delete"}}),e._v("删除")],1)],1),a("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),a("a-icon",{attrs:{type:"down"}})],1)],1):e._e()],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:e.options.alert,rowSelection:e.options.rowSelection},scopedSlots:e._u([{key:"serial",fn:function(t,r,o){return a("span",{},[e._v(" "+e._s(o+1)+" ")])}},{key:"desc",fn:function(t,r,o){return a("span",{},[a("Ellipsis",{attrs:{length:36,tooltip:""}},[e._v(e._s(t))])],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}})],a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[e._v(" 更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{on:{click:function(t){return e.handleDetail(r)}}},[e._v("详情")])]),e.$auth("support.delete")?a("a-menu-item",[a("a",{on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")])]):e._e()],1)],1)],2)}}])})],1)},h=[],f=a("de52"),b=a.n(f),y=a("2af9"),v=a("0fea"),C={name:"DepartmentList",components:{STable:y["o"],Ellipsis:y["h"]},data:function(){var e=this;return{mdl:{},advanced:!1,queryParam:{},columns:[{title:"序号",scopedSlots:{customRender:"serial"}},{title:"部门ID",dataIndex:"departmentCode"},{title:"部门名称",dataIndex:"departmentName"},{title:"部门简称",dataIndex:"departmentMask"},{title:"描述",dataIndex:"departmentDesc",scopedSlots:{customRender:"desc"}},{title:"状态",dataIndex:"canceled",customRender:function(e,t,a){return 0===e?"启用":"封存"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],loadData:function(t){return e.queryParam=Object.assign(e.queryParam,t),console.log("loadData.parameter",e.queryParam),Object(v["f"])(e.queryParam).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[],options:{alert:{show:!0,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}}},created:function(){},methods:{handleAdd:function(){this.$emit("onAdd")},handleEdit:function(e){this.$emit("onEdit",e)},handleDelete:function(e){var t=this,a=[e.id];Object(v["a"])(a).then((function(e){200===e.code&&(t.$refs.table.refresh(!1),t.$message.success("删除成功"))})).catch((function(){console.log("deleteDepartment err:",res),t.$message.error("删除失败")}))},batchDelete:function(){var e=this;console.log("this.selectedRowKeys",this.selectedRowKeys),Object(v["a"])(this.selectedRowKeys).then((function(t){200===t.code&&(_this.$refs.table.refresh(!1),e.$message.success("删除成功"))}))},handleDetail:function(e){e.type="department",this.$emit("onDetail",e)},reset:function(){this.queryParam.departmentName=null,this.queryParam.canceled=null},refresh:function(e){var t=this;console.log("refresh:",e),console.log("this.queryParam:",this.queryParam),this.queryParam=Object.assign(this.queryParam,e),console.log("refresh.parameter",this.queryParam),this.loadData=function(e){return Object(v["f"])(t.queryParam).then((function(e){return e.result}))},this.$refs.table.refresh(!0)},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){console.log("resetSearchForm"),this.queryParam={date:b()(new Date)}}}},g=C,w=Object(d["a"])(g,p,h,!1,null,null,null),D=w.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd2()}}},[e._v("新建分部")]),e.selectedRowKeys.length>0?a("a-dropdown",{directives:[{name:"action",rawName:"v-action:update",arg:"update"}]},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1",on:{click:function(t){return e.batchDelete()}}},[a("a-icon",{attrs:{type:"delete"}}),e._v("删除")],1)],1),a("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),a("a-icon",{attrs:{type:"down"}})],1)],1):e._e()],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:e.options.alert,rowSelection:e.options.rowSelection},scopedSlots:e._u([{key:"serial",fn:function(t,r,o){return a("span",{},[e._v(" "+e._s(o+1)+" ")])}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}})],a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[e._v(" 更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a",{on:{click:function(t){return e.handleDetail(r)}}},[e._v("详情")])]),e.$auth("support.delete")?a("a-menu-item",[a("a",{on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")])]):e._e()],1)],1)],2)}}])})],1)},S=[],I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[e.isSubCompany?a("detail-list",{attrs:{title:"分部信息"}},[a("detail-list-item",{attrs:{term:"分部编号"}},[e._v(e._s(e.subCompany.subCompanyCode))]),a("detail-list-item",{attrs:{term:"分部名称"}},[e._v(e._s(e.subCompany.subCompanyName))]),a("detail-list-item",{attrs:{term:"上级分部"}},[e._v(e._s(e.supSubCompanyName))]),a("detail-list-item",{attrs:{term:"状态"}},[e._v(e._s(e.statusObj[e.subCompany.canceled]))]),a("detail-list-item",{attrs:{term:"排序"}},[e._v(e._s(e.subCompany.showOrder))]),a("detail-list-item",{attrs:{term:"是否独立站点"}},[e._v(e._s(e.aloneSiteObj[e.subCompany.aloneSite]))])],1):a("detail-list",{attrs:{title:"部门信息"}},[a("detail-list-item",{attrs:{term:"部门编号"}},[e._v(e._s(e.department.departmentCode))]),a("detail-list-item",{attrs:{term:"部门名称"}},[e._v(e._s(e.department.departmentName))]),a("detail-list-item",{attrs:{term:"部门简称"}},[e._v(e._s(e.department.departmentMask))]),a("detail-list-item",{attrs:{term:"上级部门"}},[e._v(e._s(e.supDeptName))]),a("detail-list-item",{attrs:{term:"状态"}},[e._v(e._s(e.statusObj[e.department.canceled]))]),a("detail-list-item",{attrs:{term:"排序"}},[e._v(e._s(e.department.showOrder))]),a("detail-list-item",{attrs:{term:"所属分部"}},[e._v(e._s(e.subCompanyName))]),a("detail-list-item",{attrs:{term:"描述"}},[e._v(e._s(e.department.departmentDesc))])],1)],1)},x=[],O=a("c16f"),N=O["a"].Item,j={name:"DepartmentInfo",components:{DetailList:O["a"],DetailListItem:N},data:function(){return{isSubCompany:!1,department:{},subCompany:{},supSubCompanyName:"",supDeptName:"",subCompanyName:"",statusObj:{0:"启用",1:"封存"},aloneSiteObj:{0:"是",1:"否"}}},mounted:function(){},methods:{loadData:function(e,t){var a=this;a.isSubCompany={},a.department={},a.supSubCompanyName="",a.supDeptName="",a.subCompanyName="",a.isSubCompany="subCompany"===e,a.isSubCompany?Object(v["k"])({id:t}).then((function(e){a.subCompany=e.result.data[0],Object(v["k"])({id:a.subCompany.supSubCompanyId}).then((function(e){console.log(" res.result.data[0]",e.result.data[0]),e.result.data[0]&&(a.supSubCompanyName=e.result.data[0].subCompanyName)}))})):Object(v["f"])({id:t}).then((function(e){a.department=e.result.data[0],Object(v["k"])({id:a.department.subCompanyId}).then((function(e){e.result.data[0]&&(a.subCompanyName=e.result.data[0].subCompanyName)})),Object(v["f"])({id:a.department.supDeptId}).then((function(e){e.result.data[0]&&(a.supDeptName=e.result.data[0].departmentName)}))}))}}},$=j,_=Object(d["a"])($,I,x,!1,null,null,null),T=_.exports,P={name:"SubCompanyList",components:{STable:y["o"],DepartmentInfo:T},data:function(){var e=this;return{mdl:{},advanced:!1,queryParam:{},title:"分部详情",columns:[{title:"序号",scopedSlots:{customRender:"serial"}},{title:"分部代码",dataIndex:"subCompanyCode"},{title:"分部名称",dataIndex:"subCompanyName"},{title:"状态",dataIndex:"canceled",customRender:function(e,t,a){return 0===e?"启用":"封存"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],loadData:function(t){return console.log("parameter",t),console.log("Subompany",e),e.queryParam=Object.assign(e.queryParam,t),e.queryParam.supSubCompanyId=e.$attrs.supSubCompanyId,console.log("loadData.parameter",e.queryParam),Object(v["k"])(e.queryParam).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[],options:{alert:{show:!0,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}}},created:function(){},monted:function(){console.log("SubCompanyList monted",this)},methods:{handleAdd2:function(){this.$emit("onAdd2")},handleEdit:function(e){this.$emit("onEditSub",e)},handleDelete:function(e){var t=this,a=[e.id];Object(v["d"])(a).then((function(e){200===e.code&&(t.$refs.table.refresh(!1),t.$message.success("删除成功"))})).catch((function(){t.$message.error("删除失败")}))},batchDelete:function(){var e=this;console.log("this.selectedRowKeys",this.selectedRowKeys),Object(v["d"])(this.selectedRowKeys).then((function(t){200===t.code&&(_this.$refs.table.refresh(!1),e.$message.success("删除成功"))}))},handleDetail:function(e){e.type="subCompany",this.$emit("onDetail",e)},refresh:function(e){var t=this;console.log("refresh:",e),console.log("this.queryParam:",this.queryParam),this.queryParam=Object.assign(this.queryParam,e),console.log("refresh.parameter",this.queryParam),this.loadData=function(e){return Object(v["k"])(t.queryParam).then((function(e){return e.result}))},this.$refs.table.refresh(!0)},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){console.log("resetSearchForm"),this.queryParam={date:b()(new Date)}}}},K=P,E=Object(d["a"])(K,k,S,!1,null,null,null),L=E.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:600,visible:e.visible,confirmLoading:e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("department-info",{ref:"departmentInfo"})],1)},q=[],F={name:"DepartmentDetail",components:{DepartmentInfo:T},data:function(){return{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},formLayout:"horizontal",title:"",visible:!1,confirmLoading:!1,mdl:{},rowId:""}},beforeCreate:function(){},created:function(){},mounted:function(){},methods:{loadData:function(e){var t=this;this.visible=!0,"subCompany"===e.type&&(this.title="分部详情"),"department"===e.type&&(this.title="部门详情"),this.$nextTick((function(){console.log("this.$refs.departmentInfo",t.$refs.departmentInfo),t.$refs.departmentInfo&&console.log("this.$refs",t.$refs.departmentInfo),t.$refs.departmentInfo.loadData(e.type,e.id)}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){this.close()},handleCancel:function(){this.close()}}},A=F,U=Object(d["a"])(A,R,q,!1,null,null,null),H=U.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("新建人员")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:e.options.alert,rowSelection:e.options.rowSelection},scopedSlots:e._u([{key:"serial",fn:function(t,r,o){return a("span",{},[e._v(" "+e._s(o+1)+" ")])}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}})],[a("a",{on:{click:function(t){return e.handleDetail(r)}}},[e._v("详情")])]],2)}}])})],1)},V=[],Y={name:"UserList",components:{STable:y["o"]},data:function(){var e=this;return{mdl:{},advanced:!1,queryParam:{},columns:[{title:"#",scopedSlots:{customRender:"serial"}},{title:"用户名",dataIndex:"username"},{title:"姓名",dataIndex:"name"},{title:"英文名",dataIndex:"englishName"},{title:"状态",dataIndex:"status",customRender:function(e,t,a){return 1===e?"正式":"离职"}},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],loadData:function(t){return Object.assign(e.queryParam,t),Object(v["o"])(e.queryParam).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[],options:{alert:{show:!0,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}}},created:function(){console.log("created.this",this)},mounted:function(){console.log("mounted.this",this),this.refresh(this.$attrs)},methods:{handleAdd:function(){this.$emit("onAddUser")},handleEdit:function(e){this.$emit("onEditUser",e)},handleDetail:function(e){this.$emit("onDetailUser",e)},refresh:function(e){var t=this;console.log("refresh:",e),console.log("this.queryParam:",this.queryParam),this.queryParam=Object.assign(this.queryParam,e),console.log("refresh.parameter",this.queryParam),this.loadData=function(e){return Object(v["o"])(t.queryParam).then((function(e){return e.result}))},this.loadData(!0),this.$refs.table.refresh(!0)},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},resetSearchForm:function(){console.log("resetSearchForm"),this.queryParam={}}}},J=Y,z=Object(d["a"])(J,M,V,!1,null,null,null),G=z.exports,W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:600,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{layout:e.formLayout,form:e.form}},[a("a-form-item",{attrs:{label:"上级部门","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["supDeptId"],expression:"['supDeptId'\n          ]"}],staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.orgTree,placeholder:"请选择上级部门","tree-default-expand-all":""},on:{change:e.onChangeSubDep}})],1),a("a-form-item",{attrs:{label:"所属分部","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["subCompanyId",{rules:[{required:!0,message:"请选择所属分部"}]}],expression:"['subCompanyId',\n            {rules: [{ required: true, message: '请选择所属分部'}]}\n          ]"}],staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.treeData,placeholder:"请选择所属分部","tree-default-expand-all":""},on:{change:e.onChangeSubCom}})],1),a("a-form-item",{attrs:{label:"部门编号","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["departmentCode",{rules:[{required:!0,message:"请输入部门编号"}]}],expression:"['departmentCode',\n            {rules: [{ required: true, message: '请输入部门编号' }]}\n          ]"}]})],1),a("a-form-item",{attrs:{label:"部门名称","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["departmentName",{rules:[{required:!0,message:"请输入部门名称"}]}],expression:"['departmentName', {\n          rules: [{ required: true, message: '请输入部门名称' }]\n        }]"}]})],1),a("a-form-item",{attrs:{label:"部门简称","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["departmentMask"],expression:"['departmentMask']"}]})],1),a("a-form-item",{attrs:{label:"状态","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["canceled",{initialValue:"0"}],expression:"['canceled',{ initialValue: '0' }]"}]},[a("a-radio",{attrs:{value:"0"}},[e._v("启用")]),a("a-radio",{attrs:{value:"1"}},[e._v("封存")])],1)],1),a("a-form-item",{attrs:{label:"排序","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["showOrder",{initialValue:"1"}],expression:"['showOrder', { initialValue: '1' }]"}]})],1),a("a-form-item",{attrs:{label:"描述","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["departmentDesc",{}],expression:"['departmentDesc', {}]"}]})],1)],1)],1)],1)},B=[],Q=(a("e18c"),a("1c2e"),a("cf73")),X=(a("1bb7"),a("85ee")),Z=a.n(X),ee={name:"Edit",components:{ATreeSelect:Q["a"]},data:function(){return{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},formLayout:"horizontal",title:"",visible:!1,confirmLoading:!1,mdl:{},rowId:"",orgTree:[],treeData:[]}},beforeCreate:function(){this.form=this.$form.createForm(this),console.log("form::",this.form)},created:function(){},methods:{init:function(){this.rowId="",this.mdl={departmentCode:"",departmentName:"",departmentMask:"",departmentDesc:"",canceled:"0",showOrder:1,supDeptId:"",subCompanyId:""}},parseDepartmentTree:function(e){for(var t in e)"subCompany"===e[t].type&&(e[t].disabled=!0,e[t]["children"]&&e[t]["children"].length>0&&this.parseDepartmentTree(e[t]["children"]))},findParentSubCompany:function(e){console.log("findParentSubCompany",e),"subCompany"===e.$parent.$options.propsData.dataRef.type?this.form.setFieldsValue({subCompanyId:e.$parent.$options.propsData.value}):this.findParentSubCompany(e.$parent)},onChangeSubDep:function(e,t,a){this.findParentSubCompany(a.triggerNode)},onChangeSubCom:function(e){this.form.setFieldsValue({supDeptId:""})},add:function(e,t,a){this.init();var r={};r="subCompany"===a?{subCompanyId:e}:{supDeptId:e,subCompanyId:t},this.edit(r),this.title="新建部门"},edit:function(e){var t=this;console.log("edit this",this),this.orgTree=JSON.parse(JSON.stringify(this.$attrs.orgTree)),this.parseDepartmentTree(this.orgTree),this.treeData=this.$attrs.subTreeData,this.title="编辑部门",console.log("record",e),this.rowId=e.id,this.mdl=Object.assign(this.mdl,e),this.mdl.canceled>=0&&null!=this.mdl.canceled&&(this.mdl.canceled=this.mdl.canceled.toString()),console.log("this.mdl",this.mdl),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(Z()(t.mdl,"departmentCode","departmentName","departmentMask","departmentDesc","canceled","showOrder","supDeptId","subCompanyId"))}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(a,r){a||(console.log("form values",r),""!==e.rowId&&(r["id"]=e.rowId),console.log("values",r),r.supDeptId&&void 0!=r.supDeptId&&""!=r.supDeptId||(r.supDeptId=r.subCompanyId),t.confirmLoading=!0,Object(v["q"])(r).then((function(e){200===e.code&&(t.$message.success("保存成功"),t.$emit("ok")),t.close()})).catch((function(){t.$message.error("保存失败")})).finally((function(){t.confirmLoading=!1,t.close()})))}))},handleCancel:function(){this.close()}}},te=ee,ae=Object(d["a"])(te,W,B,!1,null,null,null),re=ae.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:600,visible:e.visible,confirmLoading:e.confirmLoading,maskClosable:!1},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{layout:e.formLayout,form:e.form}},[a("a-form-item",{attrs:{label:"上级分部","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["supSubCompanyId",{rules:[{required:!0,message:"请选择上级分部"}]}],expression:"['supSubCompanyId',\n            {rules: [{ required: true, message: '请选择上级分部'}]}\n          ]"}],staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.subTreeData,placeholder:"请选择上级分部","tree-default-expand-all":""}})],1),a("a-form-item",{attrs:{label:"分部编号","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["subCompanyCode",{}],expression:"['subCompanyCode', {}]"}]})],1),a("a-form-item",{attrs:{label:"分部名称","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["subCompanyName",{}],expression:"['subCompanyName', {}]"}]})],1),a("a-form-item",{attrs:{label:"状态","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["canceled",{initialValue:"0"}],expression:"['canceled',{ initialValue: '0' }]"}]},[a("a-radio",{attrs:{value:"0"}},[e._v("启用")]),a("a-radio",{attrs:{value:"1"}},[e._v("封存")])],1)],1),a("a-form-item",{attrs:{label:"排序","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["showOrder",{initialValue:"1"}],expression:"['showOrder', { initialValue: '1' }]"}]})],1),a("a-form-item",{attrs:{label:"是否独立站点","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["aloneSite",{initialValue:"1"}],expression:"['aloneSite',{ initialValue: '1' }]"}]},[a("a-radio",{attrs:{value:"0"}},[e._v("是")]),a("a-radio",{attrs:{value:"1"}},[e._v("否")])],1)],1)],1)],1)],1)},ne=[],se={name:"EditSub",components:{ATreeSelect:Q["a"]},data:function(){return{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},formLayout:"horizontal",title:"",visible:!1,confirmLoading:!1,subTreeData:[],mdl:{},rowId:""}},beforeCreate:function(){this.form=this.$form.createForm(this),console.log("form::",this.form)},created:function(){},methods:{init:function(){this.rowId="",this.mdl={subCompanyName:"",subCompanyCode:"",supSubCompanyId:"",supSubCompanyName:"",canceled:"0",showOrder:1,aloneSite:"1"}},add:function(e,t){this.init(),this.edit({supSubCompanyId:e,supSubCompanyName:t}),this.title="新建分部"},edit:function(e){var t=this;this.subTreeData=this.$attrs.subTreeData,this.title="编辑分部",this.rowId=e.id,this.mdl=Object.assign(this.mdl,e),this.mdl.canceled>=0&&null!=this.mdl.canceled&&(this.mdl.canceled=this.mdl.canceled.toString()),this.mdl.aloneSite>=0&&null!=this.mdl.aloneSite&&(this.mdl.aloneSite=this.mdl.aloneSite.toString()),console.log("this.mdl",this.mdl),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(Z()(t.mdl,"id","subCompanyName","subCompanyCode","supSubCompanyId","canceled","showOrder"))}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(a,r){a||(console.log("form values",r),""!==e.rowId&&(r["id"]=e.rowId),t.confirmLoading=!0,delete r.supDeptName,Object(v["t"])(r).then((function(e){200===e.code&&(t.$message.success("保存成功"),t.$emit("ok")),t.close()})).catch((function(){t.$message.error("保存失败")})).finally((function(){t.confirmLoading=!1,t.close()})))}))},handleCancel:function(){this.close()}}},le=se,ie=Object(d["a"])(le,oe,ne,!1,null,null,null),ce=ie.exports,de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:1e3,visible:e.visible,confirmLoading:e.confirmLoading,destroyOnClose:!0,maskClosable:!1,footer:e.footer},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-form",{attrs:{form:e.form}},[a("a-card",{staticClass:"card",attrs:{title:"个人信息",bordered:!1}},[a("a-row",[a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"人员姓名",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入人员姓名"}]}],expression:"[\n              'name',\n              {rules: [{ required: true, message: '请输入人员姓名' }]}\n            ]"}],attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,placeholder:"人员姓名"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"工号",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["workcode"],expression:"['workcode']"}],attrs:{placeholder:"工号"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"英文名",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["englishName"],expression:"[\n              'englishName'\n            ]"}],attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,placeholder:"英文名"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"排序",hasFeedback:""}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["showOrder",{}],expression:"['showOrder', {}]"}],attrs:{placeholder:"排序",min:0}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录账号",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username"],expression:"['username']"}],attrs:{placeholder:"登录账号"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"登录密码",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password"],expression:"['password']"}],attrs:{disabled:e.isEdit,placeholder:"登录密码",type:"password"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"所属部门",hasFeedback:""}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["departmentId"],expression:"['departmentId']"}],staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.orgTree,placeholder:"请选择所属部门","tree-default-expand-all":""}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"直接上级",hasFeedback:""}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["leader"],expression:"['leader']"}],staticStyle:{width:"100%"},attrs:{"show-search":"",treeNodeFilterProp:"title","dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.userTreeData,placeholder:"请选择直接上级","tree-default-expand-all":""}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"身份证号",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["idNumber"],expression:"[\n              'idNumber',\n            ]"}],attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,placeholder:"身份证号"},on:{change:e.changeIdNumber}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"年龄"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["age",{}],expression:"['age', {}]"}],attrs:{placeholder:"年龄",min:0}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"性别"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["sex",{initialValue:"0"}],expression:"['sex',{ initialValue: '0' }]"}]},[a("a-radio",{attrs:{value:"0"}},[e._v("男")]),a("a-radio",{attrs:{value:"1"}},[e._v("女")])],1)],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"学历"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["qualification",{initialValue:"4"}],expression:"['qualification',{ initialValue: '4' }]"}]},[a("a-select-option",{attrs:{value:"1"}},[e._v("初中及以下")]),a("a-select-option",{attrs:{value:"2"}},[e._v("高中")]),a("a-select-option",{attrs:{value:"3"}},[e._v("大专")]),a("a-select-option",{attrs:{value:"4"}},[e._v("本科")]),a("a-select-option",{attrs:{value:"5"}},[e._v("研究生")]),a("a-select-option",{attrs:{value:"6"}},[e._v("博士")]),a("a-select-option",{attrs:{value:"7"}},[e._v("博士后")])],1)],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"联系电话",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["telephone"],expression:"[\n              'telephone'\n            ]"}],attrs:{placeholder:"联系电话"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"家庭住址",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address"],expression:"[\n              'address'\n            ]"}],attrs:{placeholder:"家庭住址"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"邮箱",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{type:"email",message:"请输入邮箱格式!"}]}],expression:"[\n              'email',\n              {rules: [{\n                type: 'email',\n                message: '请输入邮箱格式!',\n              }]}\n            ]"}],attrs:{placeholder:"邮箱"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"状态",hasFeedback:""}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:"1"}],expression:"['status', { initialValue: '1' }]"}],attrs:{placeholder:"状态"}},[a("a-select-option",{attrs:{value:"1"}},[e._v(" 正式 ")]),a("a-select-option",{attrs:{value:"2"}},[e._v(" 离职 ")])],1)],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"紧急联系人",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["emergencyContact",{}],expression:"['emergencyContact',{}]"}],attrs:{placeholder:"紧急联系人"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"紧急联系人电话",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["emergencyContactNum",{}],expression:"['emergencyContactNum',{}]"}],attrs:{placeholder:"紧急联系人电话"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"紧急联系人地址",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["emergencyAdreess",{}],expression:"['emergencyAdreess',{}]"}],attrs:{placeholder:"紧急联系人地址"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"职称",hasFeedback:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["jobtitle",{}],expression:"['jobtitle',{}]"}],attrs:{placeholder:"职称"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"合同日期",hasFeedback:""}},[a("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["contractDate",{initialValue:[e.contractDate.contractStartDate,e.contractDate.contractEndDate]}],expression:"['contractDate',{initialValue:[contractDate.contractStartDate,contractDate.contractEndDate]}]"}],attrs:{placeholder:["合同开始日期","合同结束日期"],format:"YYYY-MM-DD"}})],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"岗位",hasFeedback:""}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["post"],expression:"['post']"}],attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"show-search":"",data:e.jobList}},e._l(e.jobList,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.jobName)+" ")])})),1)],1)],1),a("a-col",{attrs:{sm:e.colsm,md:e.colmd}},[a("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"照片",hasFeedback:""}},[a("a-upload",{staticClass:"avatar-uploader",attrs:{name:"avatar","list-type":"picture-card","show-upload-list":!1,action:"/api/upload-avatar","before-upload":e.beforeUpload},on:{change:e.handleChangeAvatar}},[e.imageUrl?a("img",{attrs:{src:e.imageUrl,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(" Upload ")])],1)])],1)],1)],1)],1)],1)],1)],1)},ue=[],me=(a("dbb3"),a("4194"),a("fe59"),a("053b"),a("fe8a"),a("e35a"),a("f4e3"),a("0d7a"),a("08ba"),a("80a0")),pe=a("5c62");var he={name:"EditUser",components:{ATreeSelect:Q["a"]},data:function(){return{colsm:24,colmd:12,labelCol:{xs:{span:24},sm:{span:24},md:{span:10}},wrapperCol:{xs:{span:24},sm:{span:24},md:{span:12}},buttonCol:{wrapperCol:{xs:{span:24},sm:{span:12,offset:5}}},isEdit:!1,footer:void 0,title:"",form:this.$form.createForm(this),confirmLoading:!1,visible:!1,id:0,mdl:{},rowId:"",orgTree:[],userTreeData:[],jobList:[],contractDate:{contractStartDate:null,contractEndDate:null},loading:!1,imageUrl:"",workHisLoading:!1,workHisColumns:[{title:"所在公司",dataIndex:"companyName",key:"companyName",width:"20%",scopedSlots:{customRender:"companyName"}},{title:"岗位",dataIndex:"post",key:"post",width:"20%",scopedSlots:{customRender:"post"}},{title:"开始时间",dataIndex:"startDate",key:"startDate",width:"20%",scopedSlots:{customRender:"startDate"}},{title:"结束时间",dataIndex:"endDate",key:"endDate",width:"20%",scopedSlots:{customRender:"endDate"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],workHisData:[],familyLoading:!1,familyColumns:[{title:"姓名",dataIndex:"name",key:"name",width:"15%",scopedSlots:{customRender:"name"}},{title:"关系",dataIndex:"relation",key:"relation",width:"15%",scopedSlots:{customRender:"relation"}},{title:"联系方式",dataIndex:"contactNum",key:"contactNum",width:"20%",scopedSlots:{customRender:"contactNum"}},{title:"住址",dataIndex:"address",key:"address",width:"30%",scopedSlots:{customRender:"address"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],familyData:[]}},created:function(){},methods:{init:function(){this.rowId="",this.mdl={name:"",workcode:"",englishName:"",showOrder:"",username:"",password:"",departmentId:"",leader:"",idNumber:"",age:0,qualification:"",telephone:"",address:"",email:"",status:"",emergencyContact:"",emergencyContactNum:"",emergencyAdreess:""},this.contractDate={contractStartDate:null,contractEndDate:null},this.workHisData=[],this.familyData=[]},parseDepartmentTree:function(e){for(var t in e)"subCompany"===e[t].type&&(e[t].disabled=!0,e[t]["children"]&&e[t]["children"].length>0&&this.parseDepartmentTree(e[t]["children"]))},parseUserTree:function(e){for(var t in e)"subCompany"!==e[t].type&&"department"!==e[t].type||(e[t].disabled=!0,e[t]["children"]&&e[t]["children"].length>0&&this.parseUserTree(e[t]["children"]))},add:function(e,t){this.init(),this.edit({departmentId:e}),this.title="新建人员",this.isEdit=!1},edit:function(e){var t=this;Object(v["n"])({id:0}).then((function(e){t.userTreeData=e.result,t.parseUserTree(t.userTreeData)})),Object(v["h"])().then((function(e){t.jobList=e.result.data})),this.title="编辑人员",this.isEdit=!0,this.footer=void 0,this.rowId=e.id,this.orgTree=JSON.parse(JSON.stringify(this.$attrs.orgTree)),this.parseDepartmentTree(this.orgTree),e.sex&&(e.sex=e.sex+""),e.status&&(e.status=e.status+""),e.id&&(Object(v["g"])({userId:e.id}).then((function(e){t.familyData=e.result.data,t.familyData.forEach((function(e,t,a){e.key=e.id,e.relation=e.title,delete e.title,e.editable=!1}))})),Object(v["p"])({userId:e.id}).then((function(e){t.workHisData=e.result.data,t.workHisData.forEach((function(e,t,a){e.key=e.id,e.editable=!1,e.startDate=b()(e.startDate).format("YYYY-MM-DD"),e.endDate=b()(e.endDate).format("YYYY-MM-DD")}))}))),e.contractStartDate?this.contractDate.contractStartDate=b()(e.contractStartDate):this.contractDate.contractStartDate=b()(),e.contractEndDate?this.contractDate.contractEndDate=b()(e.contractEndDate):this.contractDate.contractEndDate=b()(),this.mdl=Object.assign({},e),this.visible=!0,this.$nextTick((function(){e.idNumber&&t.setIdNumber(e.idNumber),t.imageUrl=e.avatar;var a=Z()(t.mdl,"name","workcode","englishName","showOrder","username","departmentId","leader","post","idNumber","qualification","telephone","address","email","status","emergencyContact","emergencyContactNum","emergencyAdreess");t.form.setFieldsValue(a)}))},detail:function(e){this.edit(e),this.title="人员详情",this.footer=null},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this;console.log("handleOk:"),this.form.validateFields((function(t,a){t||(e.rowId&&(a["id"]=e.rowId,delete a["password"]),a.contractDate&&(a["contractStartDate"]=a.contractDate[0],a["contractEndDate"]=a.contractDate[1]),console.log("form values",JSON.stringify(a)),console.log("imageUrl",e.imageUrl),e.imageUrl&&(a["avatar"]=e.imageUrl),e.confirmLoading=!0,Object(v["u"])(a).then((function(t){200===t.code&&(e.$message.success("保存成功"),e.$emit("ok")),e.close()})).catch((function(){e.$message.error("保存失败")})).finally((function(){e.confirmLoading=!1})))}))},handleCancel:function(){this.close()},handleChangeAvatar:function(e){console.log("handleChangeAvatar,info",e),"uploading"!==e.file.status?"done"===e.file.status&&200===e.file.response.code&&(this.imageUrl="/api"+e.file.response.result.url,this.loading=!1):this.loading=!0},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$message.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),t&&a},changeIdNumber:function(e){console.log("changeIdNumber",e.target.value);var t=e.target.value;this.setIdNumber(t)},setIdNumber:function(e){if(18===e.length){this.birthday=e.substring(6,10)+"-"+e.substring(10,12)+"-"+e.substring(12,14);var t=this.jsGetAge(this.birthday);console.log("setIdNumber.idNo:",e);var a=(parseInt(e.substring(16,17))+1)%2+"";console.log("setIdNumber.sex:",a),this.form.setFieldsValue({age:t,sex:a})}},jsGetAge:function(e){var t,a=e.split("-"),r=a[0],o=a[1],n=a[2],s=new Date,l=s.getFullYear(),i=s.getMonth()+1,c=s.getDate();if(l==r)t=0;else{var d=l-r;if(d>0)if(i==o){var u=c-n;t=u<0?d-1:d}else{var m=i-o;t=m<0?d-1:d}else t=-1}return t},newWorkHis:function(){var e=this.workHisData.length;this.workHisData.push({key:0===e?"1":(parseInt(this.workHisData[e-1].key)+1).toString(),companyName:"",post:"",startDate:"",endDate:"",editable:!0,isNew:!0})},handleChange:function(e,t,a){var r=Object(pe["a"])(this.workHisData),o=r.find((function(e){return t===e.key}));o&&(o[a]=e,this.workHisData=r)},remove:function(e){var t=this;e.length>10&&Object(v["e"])([e]).then((function(e){t.$message.success("删除成功")}));var a=this.workHisData.filter((function(t){return t.key!==e}));this.workHisData=a},checkDate:function(e){var t=e.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(null==t)return!1;var a=new Date(t[1],t[3]-1,t[4]);return a.getFullYear()==t[1]&&a.getMonth()+1==t[3]&&a.getDate()==t[4]},saveRow:function(e){var t=this;this.workHisLoading=!0;var a=e.key,r=e.companyName,o=e.post;e.startDate,e.endDate;if(!r||!o)return this.workHisLoading=!1,void this.$message.error("请填写完整工作信息。");if(!this.checkDate(e.startDate))return this.workHisLoading=!1,void this.$message.error("开始时间的格式不对,格式：YYYY-MM-DD");if(!this.checkDate(e.endDate))return this.workHisLoading=!1,void this.$message.error("结束时间的格式不对,格式：YYYY-MM-DD");var n=JSON.parse(JSON.stringify(e));n.key.length<10?n.id="":n.id=e.key,""!==this.rowId&&(n.userId=this.rowId),Object(v["v"])(n).then((function(e){var r=t.workHisData.find((function(e){return e.key===a}));r.key=e.result.id,r.editable=!1,r.isNew=!1,t.remove(0),t.workHisLoading=!1})).finally((function(){t.workHisLoading=!1}))},toggle:function(e){var t=this.workHisData.find((function(t){return t.key===e}));t._originalData=Object(me["a"])({},t),t.editable=!t.editable,this.remove(0)},cancel:function(e){var t=this.workHisData.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0,this.remove(0)},newFamily:function(){var e=this.familyData.length;this.familyData.push({key:0===e?"1":(parseInt(this.familyData[e-1].key)+1).toString(),name:"",relation:"",contactNum:"",address:"",editable:!0,isNew:!0})},handleFamilyChange:function(e,t,a){var r=Object(pe["a"])(this.familyData),o=r.find((function(e){return t===e.key}));o&&(o[a]=e,this.familyData=r)},removeFamily:function(e){var t=this;e.length>10&&Object(v["b"])([e]).then((function(e){t.$message.success("删除成功")}));var a=this.familyData.filter((function(t){return t.key!==e}));this.familyData=a},saveFamilyRow:function(e){var t=this;this.familyDataLoading=!0;var a=e.key,r=e.name,o=e.relation;e.contactNum,e.address;if(!r||!o)return this.familyDataLoading=!1,void this.$message.error("请填写完整家庭成员信息。");var n={name:e.name,title:e.relation,contactNum:e.contactNum,address:e.address};e.key.length<10?n.id="":n.id=e.key,""!==this.rowId&&(n.userId=this.rowId),console.log("familyData",this.familyData),Object(v["r"])(n).then((function(e){var r=t.familyData.find((function(e){return e.key===a}));r.key=e.result.id,console.log("target",r),r.editable=!1,r.isNew=!1,t.removeFamily(0),t.familyLoading=!1}))},toggleFamily:function(e){var t=this.familyData.find((function(t){return t.key===e}));t._originalData=Object(me["a"])({},t),t.editable=!t.editable,this.removeFamily(0)},cancelFamily:function(e){var t=this.familyData.find((function(t){return t.key===e}));Object.keys(t).forEach((function(e){t[e]=t._originalData[e]})),t._originalData=void 0,this.removeFamily(0)}}},fe=he,be=(a("6930"),Object(d["a"])(fe,de,ue,!1,null,null,null)),ye=be.exports,ve={name:"TreeList",components:{DepartmentTree:m,DepartmentList:D,SubCompanyList:L,DepartmentInfo:T,DepartmentDetail:H,UserList:G,Edit:re,EditSub:ce,EditUser:ye},data:function(){return{orgTree:[],subTreeData:[],selectedRowKeys:[],selectedRows:[],selectKey:"",selectTile:"",selectType:"",currentComponet:"",subCompanyArr:[],subCompanyId:""}},created:function(){},mounted:function(){this.loadTree(!0)},methods:{loadTree:function(e){var t=this;this.subCompanyId="",Object(v["l"])({id:0}).then((function(a){t.orgTree=a.result,t.orgTree&&e&&(t.selectType=t.orgTree[0]["type"],t.selectKey=t.orgTree[0]["key"],t.selectTile=t.orgTree[0]["title"]),t.$refs.departmentInfo.loadData(t.selectType,t.selectKey),t.$refs.tree.loadData(t.orgTree,t.selectKey),t.$refs.table.refresh({supDeptId:t.selectKey}),"subCompany"===t.selectType&&t.$nextTick((function(){t.$refs.supSubTable&&t.$refs.supSubTable.refresh({supSubCompanyId:t.selectKey})})),"department"===t.selectType&&t.$refs.userTable&&t.$refs.userTable.refresh({departmentId:t.selectKey})})),Object(v["m"])({id:0}).then((function(e){t.subTreeData=e.result}))},changeTab:function(e){console.log("select tab:"+e)},getSubCompany:function(e){"subCompany"===e.$options.propsData.dataRef.type?this.subCompanyId=e.$options.propsData.dataRef.key:this.getSubCompany(e.$parent)},handleTitleClick:function(e){console.log("handleTitleClick",e),this.selectType=e.node.$options.propsData.dataRef.type,this.selectKey=e.node.$options.propsData.dataRef.key,this.selectTile=e.node.$options.propsData.title,this.subCompanyId="",this.getSubCompany(e.node),console.log("select tree, this.$refs",this.$refs),this.$refs.departmentInfo&&this.$refs.departmentInfo.loadData(this.selectType,this.selectKey),this.$refs.table&&this.$refs.table.refresh({supDeptId:this.selectKey}),this.$refs.supSubTable&&this.$refs.supSubTable.refresh({supSubCompanyId:this.selectKey}),this.$refs.userTable&&this.$refs.userTable.refresh({departmentId:this.selectKey})},handleAdd:function(){var e=this.$refs.edit;console.log("add button, item",this.selectKey),this.selectKey?e.add(this.selectKey,this.subCompanyId,this.selectType):this.$message.success("没有选择部门节点")},handleAddSub:function(){var e=this.$refs.editSub;console.log("add button, item",this.selectKey),this.selectKey?e.add(this.selectKey,this.selectTile):e.add("0","根目录")},handleEdit:function(e){"subCompany"===this.selectType?e["subCompanyId"]=this.selectKey:e["supDeptId"]=this.selectKey,console.log("edit button, item",e),this.$refs.edit.edit(e)},handleEditSub:function(e){e["supSubCompanyId"]=this.selectKey,e["supSubCompanyName"]=this.selectTile,console.log("edit button, item",e),this.$refs.editSub.edit(e)},handleEdit2:function(){var e=this;Object(v["f"])({id:this.selectKey}).then((function(t){var a=t.result.data[0];e.$refs.edit.edit(a)}))},handleEditSub2:function(){var e=this;Object(v["k"])({id:this.selectKey}).then((function(t){var a=t.result.data[0];e.$refs.editSub.edit(a)}))},handleDetail:function(e){this.$refs.detail.loadData(e)},handleSaveOk:function(){this.loadTree(!1),this.$refs.table.refresh({supDeptId:this.selectKey})},handleSaveClose:function(){},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleAddUser:function(){this.selectKey?this.$refs.editUser.add(this.selectKey,this.selectTile):this.$message.warn("请先选择上级部门")},handleEditUser:function(e){e["departmentId"]=this.selectKey,e["departmentName"]=this.selectTile,console.log("edit button, item",e),this.$refs.editUser.edit(e)},handleDetailUser:function(e){e["departmentId"]=this.selectKey,e["departmentName"]=this.selectTile,console.log("edit button, item",e),this.$refs.editUser.detail(e)},SaveSubOk:function(){this.loadTree(!1),this.$refs.supSubTable.refresh({supSubCompanyId:this.selectKey})},SaveSubClose:function(){},SaveUserOk:function(){this.$refs.userTable.refresh({departmentId:this.selectKey})},SaveUserClose:function(){}}},Ce=ve,ge=(a("d229"),Object(d["a"])(Ce,r,o,!1,null,null,null));t["default"]=ge.exports},"5c62":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("b49a");function o(e){if(Array.isArray(e))return Object(r["a"])(e)}a("f3dd"),a("0a51"),a("9b11"),a("98e0"),a("a133"),a("e18c"),a("96db"),a("af86");function n(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var s=a("271f");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e){return o(e)||n(e)||Object(s["a"])(e)||l()}},6930:function(e,t,a){"use strict";var r=a("dfa9"),o=a.n(r);o.a},"85ee":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,o="[object Arguments]",n="[object Function]",s="[object GeneratorFunction]",l="[object Symbol]",i="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,d=i||c||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,r=e?e.length:0,o=Array(r);while(++a<r)o[a]=t(e[a],a,e);return o}function p(e,t){var a=-1,r=t.length,o=e.length;while(++a<r)e[o+a]=t[a];return e}var h=Object.prototype,f=h.hasOwnProperty,b=h.toString,y=d.Symbol,v=h.propertyIsEnumerable,C=y?y.isConcatSpreadable:void 0,g=Math.max;function w(e,t,a,r,o){var n=-1,s=e.length;a||(a=I),o||(o=[]);while(++n<s){var l=e[n];t>0&&a(l)?t>1?w(l,t-1,a,r,o):p(o,l):r||(o[o.length]=l)}return o}function D(e,t){return e=Object(e),k(e,t,(function(t,a){return a in e}))}function k(e,t,a){var r=-1,o=t.length,n={};while(++r<o){var s=t[r],l=e[s];a(l,s)&&(n[s]=l)}return n}function S(e,t){return t=g(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,o=g(a.length-t,0),n=Array(o);while(++r<o)n[r]=a[t+r];r=-1;var s=Array(t+1);while(++r<t)s[r]=a[r];return s[t]=n,u(e,this,s)}}function I(e){return N(e)||O(e)||!!(C&&e&&e[C])}function x(e){if("string"==typeof e||E(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function O(e){return $(e)&&f.call(e,"callee")&&(!v.call(e,"callee")||b.call(e)==o)}var N=Array.isArray;function j(e){return null!=e&&T(e.length)&&!_(e)}function $(e){return K(e)&&j(e)}function _(e){var t=P(e)?b.call(e):"";return t==n||t==s}function T(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function P(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function K(e){return!!e&&"object"==typeof e}function E(e){return"symbol"==typeof e||K(e)&&b.call(e)==l}var L=S((function(e,t){return null==e?{}:D(e,m(w(t,1),x))}));e.exports=L}).call(this,a("9edd"))},aa66:function(e,t,a){},c16f:function(e,t,a){"use strict";var r,o,n=a("fa43"),s=n["a"],l=s,i=a("4023"),c=Object(i["a"])(l,r,o,!1,null,null,null);t["a"]=c.exports},d229:function(e,t,a){"use strict";var r=a("e995"),o=a.n(r);o.a},dfa9:function(e,t,a){},e995:function(e,t,a){}}]);